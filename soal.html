<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Latihan Soal Interaktif</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      background: #121212;
      font-family: "Poppins", sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      color: #f5f5f5;
    }
    .container {
      width: 90%;
      max-width: 750px;
      padding: 25px;
      background: #1e1e1e;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,.6);
    }
    h1 {
      text-align: center;
      color: #4cafef;
      margin-bottom: 15px;
    }
    #skor-tertinggi, #riwayat-skor {
      text-align: center;
      font-weight: 500;
      margin-bottom: 12px;
      color: #ccc;
    }
    #progress-bar {
      width: 100%;
      background: #333;
      border-radius: 8px;
      height: 12px;
      margin-bottom: 15px;
      overflow: hidden;
    }
    #progress {
      height: 100%;
      width: 0%;
      background: #4cafef;
      transition: width .4s;
    }
    #timer {
      text-align: right;
      font-weight: bold;
      color: #ff5252;
      margin-bottom: 10px;
    }
    #soal {
      font-size: 1.2rem;
      font-weight: 600;
      margin: 15px 0;
      color: #fff;
    }
    #pilihan label {
      display: block;
      margin-bottom: 10px;
      padding: 12px;
      border: 1px solid #444;
      border-radius: 8px;
      cursor: pointer;
      transition: .3s;
      background: #2a2a2a;
      color: #ddd;
    }
    #pilihan label:hover {
      background: #333;
    }
    #pilihan input[type=radio] {
      margin-right: 8px;
      accent-color: #4cafef;
    }
    #pilihan label.correct {
      background: #1b5e20;
      border-color: #2e7d32;
      color: #c8e6c9;
    }
    #pilihan label.incorrect {
      background: #b71c1c;
      border-color: #e57373;
      color: #ffcdd2;
    }
    button {
      width: 100%;
      padding: 14px;
      background: #4cafef;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      margin-top: 10px;
      transition: .3s;
    }
    button:hover {
      background: #2196f3;
    }
    button:disabled {
      background: #555;
      cursor: not-allowed;
    }
    #hasil {
      margin-top: 15px;
      font-weight: 600;
      text-align: center;
      color: #f5f5f5;
    }
    #rincian {
      margin-top: 20px;
    }
    #rincian h3 {
      margin-bottom: 10px;
    }
    .soal-review {
      border: 1px solid #444;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 10px;
      background: #2a2a2a;
    }
    .soal-review.correct {
      background: #1b5e20;
      color: #c8e6c9;
    }
    .soal-review.incorrect {
      background: #880e4f;
      color: #f8bbd0;
    }
    .hidden {display:none;}
  </style>
</head>
<body>
  <div class="container">
    <h1>Latihan Soal Interaktif</h1>
    <div id="skor-tertinggi"></div>
    <div id="riwayat-skor"></div>

    <div id="kategori-section">
      <label>Kategori:
        <select id="kategori-select">
          <option value="umum">Umum</option>
          <option value="ipa">IPA</option>
        </select>
      </label><br><br>
      <label>Mode Kuis:
        <select id="mode-select">
          <option value="langsung">Jawaban Langsung</option>
          <option value="akhir">Jawaban di Akhir</option>
        </select>
      </label><br><br>
      <label><input type="checkbox" id="use-timer" checked> Gunakan Timer (20 detik/soal)</label><br>
      <label><input type="checkbox" id="acak-soal" checked> Acak Soal</label><br>
      <button id="mulai-btn">Mulai Kuis</button>
    </div>

    <div id="kuis-section" class="hidden">
      <div id="progress-bar"><div id="progress"></div></div>
      <div id="timer"></div>
      <div id="soal"></div>
      <div id="pilihan"></div>
      <button id="submit">Cek Jawaban</button>
      <div id="hasil"></div>
      <button id="ulang-btn" class="hidden">üîÑ Ulang Kuis</button>
      <button id="home-btn" class="hidden">üè† Kembali ke Home</button>
      <div id="rincian"></div>
    </div>
  </div>

  <script>
    const soalPerKategori={
      umum:[
        {pertanyaan:"Apa ibukota Indonesia?",pilihan:["Bandung","Jakarta","Surabaya","Medan","Makassar"],jawaban:"Jakarta"},
        {pertanyaan:"7x8 = ?",pilihan:["54","56","64","63","48"],jawaban:"56"}
      ],
      ipa:[
        {pertanyaan:"Rumus air?",pilihan:["O2","H2O","CO2","NaCl","H2"],jawaban:"H2O"},
        {pertanyaan:"Planet terdekat Matahari?",pilihan:["Bumi","Venus","Merkurius","Mars","Jupiter"],jawaban:"Merkurius"}
      ]
    };

    let soalAktif=[],currentSoalIndex=0,score=0,modeKuis="langsung",gunakanTimer=true,acakSoal=true;
    let skorTertinggi=localStorage.getItem("skorTertinggi")||0;
    let riwayatSkor=JSON.parse(localStorage.getItem("riwayatSkor")||"[]");
    let timerInterval,waktuPerSoal=20,startTime, endTime;
    let jawabanUser=[];

    const kategoriSection=document.getElementById("kategori-section");
    const kuisSection=document.getElementById("kuis-section");
    const mulaiBtn=document.getElementById("mulai-btn");
    const submitBtn=document.getElementById("submit");
    const ulangBtn=document.getElementById("ulang-btn");
    const homeBtn=document.getElementById("home-btn");
    const soalEl=document.getElementById("soal");
    const pilihanEl=document.getElementById("pilihan");
    const hasilEl=document.getElementById("hasil");
    const rincianEl=document.getElementById("rincian");
    const progressEl=document.getElementById("progress");
    const timerEl=document.getElementById("timer");
    const skorTertinggiEl=document.getElementById("skor-tertinggi");
    const riwayatSkorEl=document.getElementById("riwayat-skor");

    skorTertinggiEl.innerHTML=`Skor Tertinggi: <span style="color:#4cafef">${skorTertinggi}</span>`;
    riwayatSkorEl.innerHTML=riwayatSkor.length?`Riwayat Skor: ${riwayatSkor.join(", ")}`:"Belum ada riwayat";

    function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}}

    function mulaiKuis(){
      const kategori=document.getElementById("kategori-select").value;
      modeKuis=document.getElementById("mode-select").value;
      gunakanTimer=document.getElementById("use-timer").checked;
      acakSoal=document.getElementById("acak-soal").checked;

      soalAktif=[...soalPerKategori[kategori]];
      if(acakSoal)shuffle(soalAktif);
      currentSoalIndex=0;score=0;jawabanUser=[];startTime=new Date();

      kategoriSection.classList.add("hidden");
      kuisSection.classList.remove("hidden");
      submitBtn.disabled=false;
      tampilkanSoal();
    }

    function tampilkanSoal(){
      clearInterval(timerInterval);
      if(currentSoalIndex<soalAktif.length){
        const data=soalAktif[currentSoalIndex];
        soalEl.textContent=`${currentSoalIndex+1}. ${data.pertanyaan}`;
        pilihanEl.innerHTML="";
        let pilihan=[...data.pilihan];shuffle(pilihan);
        pilihan.forEach(p=>{
          pilihanEl.innerHTML+=`<label><input type="radio" name="pilihan" value="${p}">${p}</label>`;
        });
        hasilEl.textContent="";
        updateProgress();
        if(gunakanTimer)mulaiTimer(); else timerEl.textContent="";
      }else tampilkanHasil();
    }

    function cekJawaban(){
      const pilih=document.querySelector("input[name='pilihan']:checked");
      if(!pilih){alert("Pilih jawaban dulu!");return;}
      const jawaban=pilih.value;
      const benar=soalAktif[currentSoalIndex].jawaban;
      jawabanUser.push({soal:soalAktif[currentSoalIndex].pertanyaan,jawabanAnda:jawaban,jawabanBenar:benar,correct:jawaban===benar});
      if(jawaban===benar)score++;
      if(modeKuis==="langsung"){
        document.querySelectorAll("#pilihan label").forEach(l=>{
          const val=l.querySelector("input").value;
          if(val===benar)l.classList.add("correct");
          if(val===jawaban&&jawaban!==benar)l.classList.add("incorrect");
        });
        hasilEl.textContent=jawaban===benar?"‚úÖ Benar":"‚ùå Salah";
        setTimeout(()=>{currentSoalIndex++;tampilkanSoal();},1000);
      }else{currentSoalIndex++;tampilkanSoal();}
    }

    function tampilkanHasil(){
      endTime=new Date();
      const total=soalAktif.length;
      const durasi=Math.round((endTime-startTime)/1000);
      hasilEl.innerHTML=`üèÅ Selesai! Skor: ${score}/${total}<br>‚è±Ô∏è Waktu: ${durasi} detik`;
      riwayatSkor.push(score);
      localStorage.setItem("riwayatSkor",JSON.stringify(riwayatSkor));
      riwayatSkorEl.innerHTML=`Riwayat Skor: ${riwayatSkor.join(", ")}`;
      if(score>skorTertinggi){
        skorTertinggi=score;
        localStorage.setItem("skorTertinggi",skorTertinggi);
        skorTertinggiEl.innerHTML=`Skor Tertinggi Baru: ${skorTertinggi}`;
      }
      submitBtn.disabled=true;
      ulangBtn.classList.remove("hidden");
      homeBtn.classList.remove("hidden");
      tampilkanRincian();
    }

    function tampilkanRincian(){
      rincianEl.innerHTML="<h3>Rincian Jawaban:</h3>";
      jawabanUser.forEach((j,i)=>{
        rincianEl.innerHTML+=`
          <div class="soal-review ${j.correct?"correct":"incorrect"}">
            <b>Soal ${i+1}:</b> ${j.soal}<br>
            Jawaban Anda: ${j.jawabanAnda}<br>
            Jawaban Benar: ${j.jawabanBenar}<br>
            Status: ${j.correct?"‚úÖ Benar":"‚ùå Salah"}
          </div>`;
      });
    }

    function ulangKuis(){
      kategoriSection.classList.remove("hidden");
      kuisSection.classList.add("hidden");
      ulangBtn.classList.add("hidden");
      homeBtn.classList.add("hidden");
      rincianEl.innerHTML="";
    }

    function kembaliHome(){
      window.location.href="index.html";
    }

    function updateProgress(){progressEl.style.width=`${(currentSoalIndex/soalAktif.length)*100}%`;}
    function mulaiTimer(){let w=waktuPerSoal;timerEl.textContent=`‚è≥ ${w}s`;timerInterval=setInterval(()=>{w--;timerEl.textContent=`‚è≥ ${w}s`;if(w<=0){clearInterval(timerInterval);currentSoalIndex++;tampilkanSoal();}},1000);}

    mulaiBtn.addEventListener("click",mulaiKuis);
    submitBtn.addEventListener("click",cekJawaban);
    ulangBtn.addEventListener("click",ulangKuis);
    homeBtn.addEventListener("click",kembaliHome);
  </script>
</body>
</html>